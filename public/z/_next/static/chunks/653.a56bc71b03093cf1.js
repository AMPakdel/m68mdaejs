(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[653],{8653:function(n,o,t){"use strict";t.r(o),t.d(o,{default:function(){return C}});var e=t(4111),a=t(51438),s=t(52951),l=t(14924),d=t(88029),i=t(60460),r=t(85893),c=function(){function n(o){var t=this;(0,a.Z)(this,n),(0,l.Z)(this,"downloadsSetList",(function(n,o){console.log(o);var e=[],a=[];o.forEach((function(n){"finished"===n.status?a.push(n):e.push(n)})),e=e.reverse(),a=a.reverse(),t.view.setState({downloadings:e,completeds:a})})),(0,l.Z)(this,"downloadObserver",(function(n){var o=n.status,e=n.data;console.log({status:o,data:e}),e.upload_key&&t.updateDownloadList(o,e)})),(0,l.Z)(this,"updateDownloadList",(function(n,o){switch(n){case"progress":var e,a,s,l,d,i;if(null===o||void 0===o||null===(e=o.progress)||void 0===e||null===(a=e.total)||void 0===a?void 0:a.percentage)t.updateInDownloadingList(o.upload_key,{percent:Math.floor(null===o||void 0===o||null===(s=o.progress)||void 0===s||null===(l=s.total)||void 0===l?void 0:l.percentage),status:"downloading",downloaded_size:null===o||void 0===o||null===(d=o.progress)||void 0===d||null===(i=d.total)||void 0===i?void 0:i.bytes});break;case"paused":t.updateInDownloadingList(o.upload_key,{status:"paused"});break;case"finished":t.updateInDownloadingList(o.upload_key,{percent:100,status:"finished"},(function(){t.downloadsSetList(null,t.view.state.downloadings.concat(t.view.state.completeds))}));break;case"error":t.updateInDownloadingList(o.upload_key,{status:"error"})}})),(0,l.Z)(this,"onStartDownload",(function(n){var o=n.course_pk,e={upload_key:n.upload_key,title:n.title,ext:n.ext,size:n.size,type:n.type,url:n.url};window.electronAPI.downloadStart({course_pk:o,content:e}),t.updateInDownloadingList(n.upload_key,{status:"loading"})})),(0,l.Z)(this,"onPauseDownload",(function(n){window.electronAPI.downloadPause(n.upload_key),t.updateInDownloadingList(n.upload_key,{status:"loading"})})),(0,l.Z)(this,"onCancelDownload",(function(n){window.electronAPI.downloadCancel(n.upload_key),t.updateInDownloadingList(n.upload_key,{status:"loading"})})),(0,l.Z)(this,"onShowContent",(function(n){window.electronAPI.downloadsShowContent({course_pk:n.course_pk,upload_key:n.upload_key})})),this.view=o}return(0,s.Z)(n,[{key:"updateInDownloadingList",value:function(n,o,t){var e=[];this.view.state.downloadings.forEach((function(t,a){t.upload_key===n?e.push(Object.assign(t,o)):e.push(t)})),console.log("updatingDl",e),this.view.setState({downloadings:e},t)}}]),n}(),u=t(4078),w=t(67294),p=t(69215),_=t(19351),h=t.n(_),g=t(76129),v=t(55074),f=function(n){(0,d.Z)(t,n);var o=(0,i.Z)(t);function t(n){var s;return(0,a.Z)(this,t),s=o.call(this,n),(0,l.Z)((0,e.Z)(s),"onPause",(function(){"loading"!==s.props.data.status&&s.props.onPause(s.props.data)})),(0,l.Z)((0,e.Z)(s),"onStart",(function(){"loading"!==s.props.data.status&&s.props.onStart(s.props.data)})),(0,l.Z)((0,e.Z)(s),"onCancel",(function(){s.props.onCancel(s.props.data)})),(0,l.Z)((0,e.Z)(s),"onShow",(function(){s.props.onShow(s.props.data)})),(0,l.Z)((0,e.Z)(s),"renderTextStatus",(function(n){return"loading"===n?(0,r.jsx)("div",{className:h().status_loading,children:(0,r.jsx)(g.Z,{scale:.25})}):"finished"===n?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:h().status_tx+" fsu",children:"\u062f\u0627\u0646\u0644\u0648\u062f \u0628\u0647 \u0627\u062a\u0645\u0627\u0645 \u0631\u0633\u06cc\u062f\u0647."})}):"downloading"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:h().status_tx,children:"\u062f\u0631\u062d\u0627\u0644 \u062f\u0627\u0646\u0644\u0648\u062f"}),(0,r.jsx)("div",{className:h().change_btn+" fpc1",onClick:s.onPause,children:"\u062a\u0648\u0642\u0641 \u062f\u0627\u0646\u0644\u0648\u062f"})]}):"paused"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:h().status_tx,children:"\u062a\u0648\u0642\u0641 \u062f\u0627\u0646\u0644\u0648\u062f"}),(0,r.jsx)("div",{className:h().change_btn+" fpc1",onClick:s.onStart,children:"\u0634\u0631\u0648\u0639 \u062f\u0627\u0646\u0644\u0648\u062f"})]}):"error"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:h().status_tx+" fdg",children:"\u0645\u0634\u06a9\u0644 \u0627\u062a\u0635\u0627\u0644 \u0628\u0647 \u0633\u0631\u0648\u0631"}),(0,r.jsx)("div",{className:h().change_btn+" fpc1",onClick:s.onStart,children:"\u062a\u0644\u0627\u0634 \u0645\u062c\u062f\u062f"})]}):null})),s.state={},s}return(0,s.Z)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var n=this.props.data||{},o="#6F3AF9";return"paused"===n.status?o="#F9A83A":"error"===n.status&&(o="#F93A3A"),(0,r.jsxs)("div",{className:h().con+" bgw md_card_shd "+this.props.className,children:["finished"===n.status?null:(0,r.jsx)("img",{className:h().close+" amp_btn",src:"/img/close_sqr.svg",onClick:this.onCancel}),(0,r.jsxs)("div",{className:h().wrapper,children:[(0,r.jsx)("div",{className:h().name+" fdc1",children:n.title}),(0,r.jsx)("div",{className:h().title+" fdc2",children:n.course_title}),(0,r.jsxs)("div",{className:h().row1,children:[(0,r.jsx)("div",{className:h().row2,children:this.renderTextStatus(n.status)}),"finished"===n.status?(0,r.jsx)(v.Z,{className:h().show_content,title:"\u0646\u0645\u0627\u06cc\u0634",onClick:this.onShow}):(0,r.jsx)("div",{className:h().perentage,children:(n.downloaded_size/1048576).toFixed(2)+"MB / "+(n.size/1048576).toFixed(2)+"MB ("+n.percent+"%)"})]}),"finished"===n.status?null:(0,r.jsx)(p.Ex,{className:h().progress,percent:n.percent,strokeWidth:10,strokeColor:o,trailColor:"#ddd",format:function(){return null}})]})]})}}]),t}(w.Component),m=t(37451),x=t(71177),D=t(51743),Z=t.n(D),C=function(n){(0,d.Z)(t,n);var o=(0,i.Z)(t);function t(n){var s;return(0,a.Z)(this,t),s=o.call(this,n),(0,l.Z)((0,e.Z)(s),"name","downloads"),(0,l.Z)((0,e.Z)(s),"onStartDownload",(function(n){s.controller.onStartDownload(n)})),(0,l.Z)((0,e.Z)(s),"onPauseDownload",(function(n){s.controller.onPauseDownload(n)})),(0,l.Z)((0,e.Z)(s),"onCancelDownload",(function(n){s.controller.onCancelDownload(n)})),(0,l.Z)((0,e.Z)(s),"onShowContent",(function(n){s.controller.onShowContent(n)})),s.controller=new c((0,e.Z)(s)),s.state={downloadings:[],completeds:[]},window.electronAPI.downloadsSetList(s.controller.downloadsSetList),s}return(0,s.Z)(t,[{key:"componentDidMount",value:function(){window.electronAPI.pageDidMount(this.name),u.Z.register("download",this.controller.downloadObserver)}},{key:"componentWillUnmount",value:function(){window.electronAPI.pageWillUnmount(this.name),u.Z.unregister("download",this.controller.downloadObserver)}},{key:"render",value:function(){var n=this;return(0,r.jsx)(x.Z,{selected:this.name,children:(0,r.jsx)("div",{className:Z().con,children:(0,r.jsxs)("div",{className:Z().wrapper,children:[this.state.downloadings.length?(0,r.jsxs)("div",{className:Z().downloadings_con,children:[(0,r.jsx)("div",{className:Z().sec_title+" tilt fdc2",children:"\u062f\u0631 \u062d\u0627\u0644 \u062f\u0627\u0646\u0644\u0648\u062f"}),this.state.downloadings.map((function(o,t){return(0,r.jsx)(f,{onStart:n.onStartDownload,onPause:n.onPauseDownload,onCancel:n.onCancelDownload,onShow:n.onShowContent,data:o},"a".concat(t))}))]}):null,this.state.completeds.length?(0,r.jsxs)("div",{className:Z().completeds_con,children:[(0,r.jsx)("div",{className:Z().sec_title+" tilt fdc2",children:"\u0628\u0647 \u0627\u062a\u0645\u0627\u0645 \u0631\u0633\u06cc\u062f\u0647"}),this.state.completeds.map((function(o,t){return(0,r.jsx)(f,{onStart:n.onStartDownload,onPause:n.onPauseDownload,onCancel:n.onCancelDownload,onShow:n.onShowContent,data:o},"a".concat(t))}))]}):null,this.state.downloadings.length||this.state.completeds.length?null:(0,r.jsx)(m.Z,{style:{minHeight:"30rem"},title:"\u0645\u062d\u062a\u0648\u0627\u06cc\u06cc \u062f\u0631 \u0644\u06cc\u0633\u062a \u062f\u0627\u0646\u0644\u0648\u062f\u0647\u0627 \u0642\u0631\u0627\u0631 \u0646\u062f\u0627\u0631\u062f."})]})})})}}]),t}(w.Component)},19351:function(n){n.exports={con:"DownloadCard_con__rrgt5",close:"DownloadCard_close__x30Qs",wrapper:"DownloadCard_wrapper__bLiIJ",name:"DownloadCard_name__9jilg",title:"DownloadCard_title__kzVxG",progress:"DownloadCard_progress__zDhyl",row1:"DownloadCard_row1__hZiGM",row2:"DownloadCard_row2__tj1r9",status_tx:"DownloadCard_status_tx__qDTBw",status_loading:"DownloadCard_status_loading__gTTu2",change_btn:"DownloadCard_change_btn__larwI",perentage:"DownloadCard_perentage__LxHzA",show_content:"DownloadCard_show_content__W0C1u"}},51743:function(n){n.exports={con:"Downloads_con__wIK2T",wrapper:"Downloads_wrapper__8zmFY",downloadings_con:"Downloads_downloadings_con__USDau",completeds_con:"Downloads_completeds_con__LiNkV",sec_title:"Downloads_sec_title__ReBa8"}}}]);